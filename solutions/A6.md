# Putnam 2025 A6 - Solution

## Answer

For each $k \geq 1$, the quantity $b_{2^{k+1}} - 2b_{2^k}$ is divisible by $2^{2k+2}$ but not by $2^{2k+3}$.

## Solution

### Key Identity

**Lemma 0:** $b_n = 2(b_0^2 + b_1^2 + \cdots + b_{n-1}^2) + n$ for all $n \geq 0$.

*Proof:* By induction. Base case $n=0$: $b_0 = 0 = 2 \cdot 0 + 0$. For the inductive step:
$$b_{n+1} - b_n = 2b_n^2 + 1$$
Summing from $0$ to $n-1$:
$$b_n - b_0 = 2(b_0^2 + \cdots + b_{n-1}^2) + n$$
Since $b_0 = 0$, we get $b_n = 2(b_0^2 + \cdots + b_{n-1}^2) + n$.

### First Induction

**Lemma 1:** $\nu_2(b_{n+2^k} - b_n) = k+1$ for all $n \geq 0$ and $k \geq 1$.

*Proof by induction on $k$:*

**Base case ($k=1$):** We have $b_{n+1} \equiv b_n + 1 \pmod{2}$, so $b_n \equiv n \pmod{2}$.

This means $b_n^2 + b_{n+1}^2 \equiv n^2 + (n+1)^2 \equiv 1 \pmod{4}$ (since one of $n, n+1$ is odd).

By Lemma 0:
$$b_{n+2} - b_n = 2(b_n^2 + b_{n+1}^2) + 2$$

Since $b_n^2 + b_{n+1}^2 \equiv 1 \pmod{4}$, we have $2(b_n^2 + b_{n+1}^2) \equiv 2 \pmod{8}$.

Therefore $b_{n+2} - b_n \equiv 4 \pmod{8}$, so $\nu_2(b_{n+2} - b_n) = 2 = 1+1$.

**Inductive step:** Assume $\nu_2(b_{m+2^{k-1}} - b_m) = k$ for all $m$. By Lemma 0:
$$b_{n+2^k} - b_n = 2(b_n^2 + b_{n+1}^2 + \cdots + b_{n+2^k-1}^2) + 2^k$$

Since $2^k \mid b_{n+i+2^{k-1}} - b_{n+i}$ by induction hypothesis, we have:
$$b_{n+i+2^{k-1}}^2 \equiv b_{n+i}^2 \pmod{2^{k+1}}$$

for all $i$. Therefore:
$$\sum_{i=0}^{2^k-1} b_{n+i}^2 \equiv 2\sum_{i=0}^{2^{k-1}-1} b_{n+i}^2 \pmod{2^{k+1}}$$

So:
$$b_{n+2^k} - b_n \equiv 4\sum_{i=0}^{2^{k-1}-1} b_{n+i}^2 + 2^k \pmod{2^{k+2}}$$
$$\equiv 2(b_{n+2^{k-1}} - b_n) \pmod{2^{k+2}}$$
$$\equiv 2 \cdot 2^k \pmod{2^{k+2}} = 2^{k+1} \pmod{2^{k+2}}$$

Therefore $\nu_2(b_{n+2^k} - b_n) = k+1$.

### Second Induction

**Lemma 2:** $b_{n+2^{k+1}} - 2b_{n+2^k} + b_n \equiv 2^{2k+2} \pmod{2^{2k+3}}$ for all $n \geq 0$ and $k \geq 1$.

*Proof by induction on $k$:*

**Base case ($k=1$):** We need $b_{n+4} - 2b_{n+2} + b_n \equiv 16 \pmod{32}$.

By Lemma 0, this is equivalent to showing:
$$b_{n+3}^2 + b_{n+2}^2 - b_{n+1}^2 - b_n^2 \equiv 8 \pmod{16}$$

If $n$ is even, then $b_n$ is even, so:
$$b_{n+2}^2 - b_n^2 = (b_{n+2} - b_n)(b_{n+2} + b_n) \equiv 0 \pmod{16}$$
(since $4 \mid b_{n+2} - b_n$ and $2 \mid b_n, b_{n+2}$).

If $n$ is odd, then $b_n$ is odd, and $b_{n+2} - b_n = 4m$ for odd $m$. Since $b_n$ is odd and $b_{n+2} = b_n + 4m$:
$$b_{n+2}^2 - b_n^2 = 4m(2b_n + 4m) = 8m(b_n + 2m) \equiv 8 \pmod{16}$$
(since $m$ is odd and $b_n + 2m$ is odd).

Since exactly one of $n$ and $n+1$ is odd:
$$b_{n+3}^2 + b_{n+2}^2 - b_{n+1}^2 - b_n^2 \equiv 8 \pmod{16}$$

Therefore $b_{n+4} - 2b_{n+2} + b_n \equiv 16 \pmod{32}$.

**Inductive step:** We compute:
$$b_{n+2^{k+1}} - 2b_{n+2^k} + b_n = 2\sum_{i=0}^{2^k-1}(b_{n+i+2^k}^2 - b_{n+i}^2)$$
$$= 2\sum_{i=0}^{2^k-1}(b_{n+i+2^k} - b_{n+i})(b_{n+i+2^k} + b_{n+i})$$

By Lemma 1, $\nu_2(b_{n+i+2^k} - b_{n+i}) = k+1$. Also, $b_{n+i+2^k} + b_{n+i} \equiv 2b_{n+i} \pmod{2^{k+1}}$.

So modulo $2^{2k+3}$:
$$\equiv 4\sum_{i=0}^{2^k-1}(b_{n+i+2^k} - b_{n+i})b_{n+i}$$

Using $b_{n+i+2^k} - b_{n+i} \equiv 2(b_{n+i+2^{k-1}} - b_{n+i}) \pmod{2^{k+2}}$ from Lemma 1's proof:
$$\equiv 8\sum_{i=0}^{2^k-1}(b_{n+i+2^{k-1}} - b_{n+i})b_{n+i} \pmod{2^{2k+3}}$$

Splitting the sum and using the periodicity modulo $2^k$:
$$= 8\sum_{i=0}^{2^{k-1}-1}\left[(b_{n+i+2^{k-1}} - b_{n+i})b_{n+i} + (b_{n+i+2^k} - b_{n+i+2^{k-1}})b_{n+i+2^{k-1}}\right]$$

Since $b_{n+i+2^k} - b_{n+i+2^{k-1}} \equiv b_{n+i+2^{k-1}} - b_{n+i} \pmod{2^{k+1}}$:
$$\equiv 8\sum_{i=0}^{2^{k-1}-1}(b_{n+i+2^{k-1}} - b_{n+i})(b_{n+i} + b_{n+i+2^{k-1}})$$
$$= 8\sum_{i=0}^{2^{k-1}-1}(b_{n+i+2^{k-1}}^2 - b_{n+i}^2)$$
$$= 4(b_{n+2^k} - 2b_{n+2^{k-1}} + b_n)$$
$$\equiv 4 \cdot 2^{2k} = 2^{2k+2} \pmod{2^{2k+3}}$$

by the induction hypothesis.

### Conclusion

Setting $n = 0$ in Lemma 2:
$$b_{2^{k+1}} - 2b_{2^k} + b_0 = b_{2^{k+1}} - 2b_{2^k} \equiv 2^{2k+2} \pmod{2^{2k+3}}$$

This means $b_{2^{k+1}} - 2b_{2^k}$ is divisible by $2^{2k+2}$ but not by $2^{2k+3}$.

## Illustration

| k | $b_{2^{k+1}} - 2b_{2^k}$ | $\nu_2$ | Expected |
|---|---|---|---|
| 1 | $b_4 - 2b_2 = 2776 - 8 = 2768 = 2^4 \cdot 173$ | 4 | $2(1)+2 = 4$ |
| 2 | $b_8 - 2b_4 = 2^6 \cdot (\text{odd})$ | 6 | $2(2)+2 = 6$ |
| 3 | $b_{16} - 2b_8 = 2^8 \cdot (\text{odd})$ | 8 | $2(3)+2 = 8$ |
| 4 | $b_{32} - 2b_{16} = 2^{10} \cdot (\text{odd})$ | 10 | $2(4)+2 = 10$ |
