# Putnam 2025 B4 - Solution

## Answer

$$S \leq \frac{(n+2)N}{3}$$

## Solution

### Setup and Notation

For row $i$, let:
- $x_i$ = number of nonzero entries in row $i$
- $s_i$ = sum of entries in row $i$

Then $N = x_1 + x_2 + \cdots + x_n$ and $S = s_1 + s_2 + \cdots + s_n$.

### Step 1: Two Bounds on Row Sums

**Lemma 1 (Horizontal Bound):** $s_i \leq \frac{x_i(x_i+1)}{2}$.

*Proof:* By condition (c), entries in each row are non-decreasing from left to right: $a_{i,j+1} \geq a_{i,j}$.

Let $j_0$ be the leftmost column where $a_{i,j_0} > 0$ in row $i$. Since entries are non-decreasing, all columns $j \geq j_0$ in the nonzero region have $a_{i,j} > 0$. Thus the nonzero entries form a consecutive block: columns $j_0, j_0+1, \ldots, n$, giving $x_i = n - j_0 + 1$ nonzero entries.

**Bound on each entry:** At column $j_0 - 1$:
- If $j_0 - 1 \leq n - i$: then $a_{i,j_0-1} = 0$ by condition (a).
- If $j_0 - 1 > n - i$: then $a_{i,j_0-1} = 0$ by definition of $j_0$ (leftmost nonzero).

Either way, $a_{i,j_0-1} = 0$, so by condition (c): $a_{i,j_0} \leq a_{i,j_0-1} + 1 = 1$.

For subsequent columns, applying condition (c) repeatedly:
$$a_{i,j_0+m-1} \leq a_{i,j_0} + (m-1) \leq 1 + (m-1) = m$$

for the $m$-th nonzero entry (where $m = 1, 2, \ldots, x_i$).

Therefore $s_i = \sum_{m=1}^{x_i} a_{i,j_0+m-1} \leq \sum_{m=1}^{x_i} m = \frac{x_i(x_i+1)}{2}$.

**Lemma 2 (Vertical Bound):** $s_i \leq x_1 + x_2 + \cdots + x_i$.

*Proof:* For any position $(i,j)$ in the nonzero region, we show $a_{i,j} \leq c_j^{(i)}$, where $c_j^{(i)}$ is the number of nonzero entries in column $j$ at rows $1, \ldots, i$.

Let $k$ be the largest row index with $k \leq i$ and $a_{k,j} = 0$. Such $k$ exists since row $n-j$ lies in the zero region for column $j$, and $n - j < i$ (as $(i,j)$ is in the nonzero region).

Since $k$ is maximal, all entries $a_{k+1,j}, a_{k+2,j}, \ldots, a_{i,j}$ are positive. By condition (b), consecutive entries differ by at most 1, so:
$$a_{i,j} - a_{k,j} \leq i - k$$

Since $a_{k,j} = 0$, we have $a_{i,j} \leq i - k$. The entries at rows $k+1, \ldots, i$ in column $j$ are all nonzero (by maximality of $k$), contributing at least $i - k$ to $c_j^{(i)}$. Therefore $a_{i,j} \leq i - k \leq c_j^{(i)}$.

Summing over all columns $j$ in the nonzero region of row $i$:
$$s_i = \sum_j a_{i,j} \leq \sum_j c_j^{(i)}$$

The right side counts each nonzero entry $(r, c)$ with $r \leq i$ exactly once (in the term $c_c^{(i)}$). Since all nonzero entries in rows $1, \ldots, i$ lie in columns within row $i$'s nonzero region (as the nonzero region expands with increasing row index), this sum equals $x_1 + x_2 + \cdots + x_i$.

### Step 2: Induction on $n$

We prove $S \leq \frac{n+2}{3} N$ by induction on $n$.

**Base case ($n = 2$):** The nonzero region has 3 positions: $(1,2), (2,1), (2,2)$.

By Lemmas 1 and 2: $s_1 \leq \min(1, x_1) \leq 1$ and $s_2 \leq \min(\frac{x_2(x_2+1)}{2}, N)$.

We verify the bound $S \leq \frac{4}{3}N$ directly:
- $N = 0$: $S = 0$.
- $N = 1$: $S \leq 1 \leq \frac{4}{3}$.
- $N = 2$: Using $s_2 \leq N = 2$ and $s_1 \leq 1$, we get $S \leq \min(1+2, 0+2) = 2 \leq \frac{8}{3}$.
- $N = 3$: $S = s_1 + s_2 \leq 1 + 3 = 4 = \frac{4}{3} \cdot 3$.

**Inductive step:** Assume the result holds for $n-1$. Consider the $(n-1) \times (n-1)$ submatrix $[a_{i,j}]_{i,j=1}^{n-1}$. This submatrix satisfies conditions (a), (b), (c) for parameter $n-1$, so by induction:

$$s_1 + s_2 + \cdots + s_{n-1} \leq \frac{(n-1)+2}{3}(x_1 + x_2 + \cdots + x_{n-1}) = \frac{n+1}{3}(N - x_n)$$

Adding $s_n$:
$$S \leq \frac{n+1}{3}(N - x_n) + s_n$$

We need to show $S \leq \frac{n+2}{3}N$, which reduces to:

$$s_n \leq \frac{n+2}{3}N - \frac{n+1}{3}(N - x_n) = \frac{N}{3} + \frac{n+1}{3}x_n$$

Using the better of our two bounds on $s_n$:
$$s_n \leq \min\left(x_1 + \cdots + x_n, \frac{x_n(x_n+1)}{2}\right) = \min\left(N, \frac{x_n(x_n+1)}{2}\right)$$

**Claim:** $\min\left(N, \frac{x_n(x_n+1)}{2}\right) \leq \frac{N}{3} + \frac{n+1}{3}x_n$.

*Proof by cases:*

**Case 1:** $x_n \leq \frac{2N}{n+1}$.

We use the bound $s_n \leq \frac{x_n(x_n+1)}{2}$ and show:
$$\frac{x_n(x_n+1)}{2} \leq \frac{N}{3} + \frac{n+1}{3}x_n$$

Rearranging:
$$\frac{x_n(x_n+1)}{2} - \frac{n+1}{3}x_n \leq \frac{N}{3}$$
$$\frac{x_n}{6}\left(3(x_n+1) - 2(n+1)\right) \leq \frac{N}{3}$$
$$\frac{x_n}{6}(3x_n - 2n + 1) \leq \frac{N}{3}$$

Since $x_n \leq n$, we have $3x_n - 2n + 1 \leq 3n - 2n + 1 = n + 1$.

Therefore:
$$\frac{x_n(3x_n - 2n + 1)}{6} \leq \frac{x_n(n+1)}{6} = \frac{n+1}{6}x_n$$

Using $x_n \leq \frac{2N}{n+1}$:
$$\frac{n+1}{6}x_n \leq \frac{n+1}{6} \cdot \frac{2N}{n+1} = \frac{N}{3}$$

This establishes Case 1.

**Case 2:** $x_n > \frac{2N}{n+1}$.

We use the bound $s_n \leq N$ and show:
$$N \leq \frac{N}{3} + \frac{n+1}{3}x_n$$

This simplifies to:
$$\frac{2N}{3} \leq \frac{n+1}{3}x_n$$
$$2N \leq (n+1)x_n$$
$$x_n \geq \frac{2N}{n+1}$$

which is exactly our Case 2 assumption.

This completes the induction.

### Tightness

The bound is achieved with equality when all positions in the nonzero region are filled with $a_{i,j} = i + j - n$ (the depth):

- At depth $\ell$ (where $i + j = n + \ell$), there are $n - \ell + 1$ positions
- Total positions: $N = \sum_{\ell=1}^{n}(n - \ell + 1) = \frac{n(n+1)}{2}$
- Sum of entries: $S = \sum_{\ell=1}^{n}\ell(n - \ell + 1) = \frac{n(n+1)(n+2)}{6}$
- Ratio: $\frac{S}{N} = \frac{n(n+1)(n+2)/6}{n(n+1)/2} = \frac{n+2}{3}$

This configuration satisfies all conditions:
- Condition (a): $a_{i,j} = 0$ when $i + j \leq n$ (depth $\leq 0$).
- Condition (b): $a_{i+1,j} = (i+1) + j - n = a_{i,j} + 1$.
- Condition (c): $a_{i,j+1} = i + (j+1) - n = a_{i,j} + 1$.

Therefore $S \leq \frac{(n+2)N}{3}$, with equality achieved.
